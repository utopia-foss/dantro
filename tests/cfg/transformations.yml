# Test cases for the TransformationsDAG
---
# Selecting items -------------------------------------------------------------
explicit_select:
  params:
    transform:
      - operation: getitem
        args:
          - !dag_tag dm
          - some/path
      - operation: getitem
        args:
          - !dag_node -1
          - foo
        tag: foo

      - operation: getitem
        args:
          - !dag_tag dm
          - some/path/bar
        tag: bar

  expected:
    num_nodes: 3
    num_objects: 4
    tags: [dm, foo, bar]

    results:
      foo:
        type: LinkContainer
        linked_path: TestDM/some/path/foo
        linked_type: OrderedDataGroup
        attributes: {}
      bar:
        type: LinkContainer
        linked_path: TestDM/some/path/bar
        linked_type: OrderedDataGroup
        attributes: {}


shorthand_select:
  params:
    select:
      foo: some/path/foo
      bar: some/path/bar

  expected:
    num_nodes: 2
    num_objects: 3
    tags: [dm, foo, bar]


# Basic numerical operations --------------------------------------------------

explicit_increment:
  params:
    select:
      some_data: data/zeros
    transform:
      - operation: increment
        args:
          - !dag_tag some_data
        tag: ones

      - operation: increment
        args:
          - !dag_tag ones
        tag: twos

  expected:
    num_nodes: 3
    num_objects: 4
    tags: [dm, some_data, ones, twos]
